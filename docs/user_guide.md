# 📚 Bitcoin Futures Turtle Trading Bot - 사용자 가이드

## 목차
1. [시작하기](#시작하기)
2. [백테스팅 가이드](#백테스팅-가이드)
3. [가상매매 가이드](#가상매매-가이드)
4. [실제매매 가이드](#실제매매-가이드)
5. [대시보드 사용법](#대시보드-사용법)
6. [설정 관리](#설정-관리)
7. [문제 해결](#문제-해결)

---

## 시작하기

### 1. 프로그램 설치 및 실행

#### 필수 요구사항
- **Python 3.9 이상**
- **안정적인 인터넷 연결**
- **최소 4GB RAM** (백테스트용)
- **500MB 저장공간**

#### 설치 단계
```bash
# 1. 저장소 클론
git clone https://github.com/your-username/turtle-trading.git
cd turtle-trading

# 2. 가상환경 생성 (권장)
python -m venv venv
source venv/bin/activate  # Linux/Mac
# venv\Scripts\activate   # Windows

# 3. 의존성 설치
pip install -r requirements.txt

# 4. 환경 설정
cp .env.example .env
```

#### 첫 실행
```bash
python main.py
```

성공적으로 실행되면 다음과 같은 화면이 나타납니다:

```
╔══════════════════════════════════════════════════════════════╗
║                                                              ║
║    🐢 Bitcoin Futures Turtle Trading Bot                    ║
║                                                              ║
║    Professional Algorithmic Trading System                  ║
║    Based on Original Turtle Trading Rules                   ║
╚══════════════════════════════════════════════════════════════╝

메인 메뉴
1. 백테스트 실행
2. 가상매매 시작  
3. 실제매매 시작
4. 이전 결과 보기
5. 설정
6. 종료
```

---

## 백테스팅 가이드

백테스팅은 과거 데이터를 사용하여 터틀 트레이딩 전략의 성과를 검증하는 과정입니다.

### 2.1 백테스트 설정

#### 기간 선택
- **단기 테스트**: 3-6개월 (빠른 검증용)
- **중기 테스트**: 1-2년 (계절성 고려)
- **장기 테스트**: 3년 이상 (여러 시장 사이클 포함)

> 💡 **권장**: 처음에는 1년 기간으로 테스트해보세요.

#### 타임프레임별 특징

| 타임프레임 | 특징 | 거래 빈도 | 권장 용도 |
|------------|------|-----------|-----------|
| **1m, 5m** | 스캘핑 | 매우 높음 | 고빈도 거래 |
| **15m, 1h** | 데이 트레이딩 | 높음 | 단기 거래 |
| **4h, 1d** | 스윙 트레이딩 | 보통 | **터틀 전략 최적** |
| **1w, 1M** | 장기 투자 | 낮음 | 장기 포지션 |

> ⭐ **추천**: 터틀 전략은 **일봉(1d)**에서 가장 효과적입니다.

### 2.2 백테스트 실행 단계별 가이드

#### Step 1: 메인 메뉴에서 '1. 백테스트 실행' 선택

#### Step 2: 기간 설정
```
📅 백테스트 기간 설정
1. 2024년 (1년)
2. 2023-2024년 (2년)  
3. 2022-2024년 (3년)
4. 2020-2024년 (5년)
5. 직접 입력

메뉴를 선택하세요: 2
```

#### Step 3: 타임프레임 설정
```
⏰ 타임프레임 설정
6. 일봉 (장기 거래, 터틀 전략 최적) ← 권장

메뉴를 선택하세요: 6
```

#### Step 4: 초기 자금 설정
```
💰 초기 자금 설정
2. $10,000 (일반적인 백테스트) ← 권장

메뉴를 선택하세요: 2
```

#### Step 5: 시스템 설정
```
⚙️ 터틀 트레이딩 시스템 설정
시스템 1 사용하시겠습니까? [Y/n]: Y
시스템 2 사용하시겠습니까? [Y/n]: Y
```

#### Step 6: 설정 확인 및 실행
```
📋 백테스트 설정 확인
종목: BTCUSDT
기간: 2023-01-01 ~ 2024-12-31
타임프레임: 1d
초기 자금: $10,000
시스템: 시스템 1, 시스템 2

이 설정으로 백테스트를 시작하시겠습니까? [Y/n]: Y
```

### 2.3 백테스트 결과 해석

#### 성과 요약 화면
```
📊 전체 성과 요약
초기 자금: $10,000  →  최종 자금: $15,847
총 수익률: +58.47%  |  연화 수익률: +24.3%
최대 드로다운: -12.8%  |  샤프 비율: 1.67

📈 거래 통계  
총 거래 수: 156번  |  승률: 67.3%
롱 거래: 89번 (승률 71.9%)  |  숏 거래: 67번 (승률 61.2%)
평균 수익: +$125  |  평균 손실: -$67
수익 팩터: 1.8
```

#### 주요 지표 설명

**수익성 지표**
- **총 수익률**: 전체 기간 동안의 수익률
- **연화 수익률**: 연간 기준으로 환산한 수익률
- **승률**: 수익 거래의 비율 (50% 이상 양호)
- **수익 팩터**: 총수익/총손실 (1.5 이상 우수)

**위험 지표**
- **최대 드로다운**: 최대 손실폭 (15% 이하 권장)
- **샤프 비율**: 위험 대비 수익률 (1.0 이상 우수)
- **평균 손실**: 손실 거래의 평균 크기

#### 결과 평가 기준

| 지표 | 우수 | 양호 | 보통 | 부진 |
|------|------|------|------|------|
| **연수익률** | >30% | 15-30% | 8-15% | <8% |
| **샤프 비율** | >2.0 | 1.0-2.0 | 0.5-1.0 | <0.5 |
| **최대 드로다운** | <5% | 5-10% | 10-20% | >20% |
| **승률** | >60% | 50-60% | 40-50% | <40% |

### 2.4 백테스트 결과 활용

#### 상세 분석 보기
결과 화면에서 '1. 상세 분석 보기' 선택하여:
- 월별 성과 분석
- 시스템별 성과 비교 (시스템 1 vs 시스템 2)
- 위험 분석 (최대 단일 손실, 연속 손실 등)

#### 결과 저장 및 내보내기
- **CSV 내보내기**: 거래 내역을 스프레드시트로 분석
- **JSON 저장**: 전체 백테스트 결과 보관
- **차트 생성**: 수익 곡선 시각화 (향후 지원 예정)

---

## 가상매매 가이드

가상매매는 실제 자금 없이 실시간 데이터로 터틀 전략을 실습하는 모드입니다.

### 3.1 가상매매 시작

#### Step 1: 메인 메뉴에서 '2. 가상매매 시작' 선택

#### Step 2: 거래 설정
```
📊 PAPER 트레이딩 설정
거래 종목 [BTCUSDT]: BTCUSDT
초기 자금 ($) [10000.0]: 10000
```

#### Step 3: 시스템 선택
```
사용할 터틀 시스템을 선택하세요:
1. 시스템 1만 (20일 돌파)
2. 시스템 2만 (55일 돌파)  
3. 시스템 1 + 2 (권장)

시스템 선택: 3
```

#### Step 4: 실시간 대시보드 시작
설정 완료 후 실시간 대시보드가 시작됩니다.

### 3.2 가상매매 모니터링

#### 대시보드 레이아웃
```
┌─────────────────── Bitcoin Futures Turtle Trading Bot ───────────────────┐
│ Mode: PAPER | Status: RUNNING | Time: 2025-06-12 14:30:05               │
├─────────────────────────────────────────────────────────────────────────┤
│ ACCOUNT SUMMARY                    │ CURRENT POSITIONS                  │
│ • Balance: $10,000                 │ • BTC-USDT: LONG 0.5 BTC          │
│ • P&L: +$1,250 (+12.5%)           │   Entry: $65,000 | Current: $67,500│
│ • Available: $8,750                │   P&L: +$1,250 (+3.8%)            │
├─────────────────────────────────────────────────────────────────────────┤
│ PERFORMANCE METRICS                                                     │
│ Win Rate: 65% | Sharpe: 1.2 | Max DD: -8.5% | Total Trades: 48       │
└─────────────────────────────────────────────────────────────────────────┘
```

#### 실시간 정보
- **계좌 요약**: 현재 잔고, 손익, 사용 가능 자금
- **현재 포지션**: 보유 중인 포지션과 실시간 손익
- **성과 지표**: 실시간 승률, 샤프 비율, 드로다운
- **최근 거래**: 최근 5개 거래 내역

### 3.3 가상매매 제어

#### 키보드 단축키
- **Q**: 가상매매 종료
- **P**: 일시정지/재시작
- **R**: 시스템 리셋 (모든 포지션 청산)
- **S**: 설정 변경
- **T**: 전체 거래 내역 보기

#### 가상매매 종료
`Ctrl+C` 또는 `Q` 키를 눌러 안전하게 종료할 수 있습니다.

---

## 실제매매 가이드

> ⚠️ **중요**: 실제 자금을 사용한 거래입니다. 신중하게 진행하세요.

### 4.1 사전 준비

#### Binance 계정 설정
1. **Binance 계정 생성**: [binance.com](https://binance.com)
2. **API 키 발급**:
   - Binance 로그인 → API 관리
   - 새 API 키 생성
   - 권한: "선물 거래" 활성화
   - IP 제한 설정 (보안 강화)

#### API 키 설정
`.env` 파일 편집:
```bash
# Binance API 설정
BINANCE_API_KEY=your_actual_api_key
BINANCE_SECRET_KEY=your_actual_secret_key
BINANCE_TESTNET=False  # 실제 거래용

# 거래 모드
TRADING_MODE=live
```

### 4.2 실제매매 시작

#### Step 1: 안전 확인
```
⚠️ 경고: 실제 자금을 사용한 거래입니다!
실제 거래를 시작하시겠습니까? 이는 실제 손실을 초래할 수 있습니다. [y/N]: y
```

#### Step 2: API 연결 확인
프로그램이 자동으로 API 키를 검증합니다.

#### Step 3: 거래 설정
가상매매와 동일한 설정 과정을 거칩니다.

#### Step 4: 실제매매 시작
실시간 대시보드가 "LIVE" 모드로 시작됩니다.

### 4.3 실제매매 모니터링 및 관리

#### 위험 관리 체크리스트
- [ ] **손절매 설정**: 모든 포지션에 자동 손절매 적용
- [ ] **포지션 크기**: 계좌의 1% 이상 위험 노출 금지
- [ ] **총 위험**: 전체 계좌의 20% 이상 위험 노출 시 자동 청산
- [ ] **연결 상태**: API 연결 및 데이터 피드 상태 지속 모니터링

#### 비상 상황 대응
- **즉시 중지**: `Ctrl+C` 또는 `Q` 키
- **모든 포지션 청산**: `R` 키 (리셋)
- **수동 개입**: Binance 앱/웹사이트에서 직접 거래

---

## 대시보드 사용법

### 5.1 대시보드 구성 요소

#### 헤더 영역
- **모드 표시**: LIVE/PAPER/BACKTEST
- **상태**: RUNNING/STOPPED  
- **시간**: 현재 시각
- **연결 상태**: API 및 데이터 피드 상태

#### 계좌 요약 (Account Summary)
```
💰 Account Summary
Balance:     $10,000.00
Total Value: $11,250.00  
P&L:         +$1,250 (+12.5%)
Daily P&L:   +$340 (+3.4%)
Available:   $8,750.00
Margin Used: $1,250.00 (12.5%)
```

#### 현재 포지션 (Current Positions)
```
📊 Current Positions
Symbol  Side  Size     Entry     Current   P&L        Duration
BTCUSDT LONG  0.150    $65,000   $67,500   +$375 (+5.8%) 2h 35m
```

#### 성과 지표 (Performance Metrics)
```
📈 Performance Metrics
Win Rate:        65% (Total) | 70% (Long) | 60% (Short)
Sharpe Ratio:    1.25
Profit Factor:   1.80
Max Drawdown:    -8.5%
Current DD:      -2.1%
Total Trades:    48
```

#### 최근 거래 (Recent Trades)
```
📋 Recent Trades (Last 5)
Date   Symbol   Side  Entry    Exit     P&L     Reason
06-11  BTCUSDT  LONG  $64,500  $66,200  +$850   SIGNAL
06-10  BTCUSDT  SHORT $63,800  $63,200  +$600   SIGNAL
```

### 5.2 대시보드 상호작용

#### 키보드 제어
| 키 | 기능 | 설명 |
|----|------|------|
| **Q** | 종료 | 프로그램 안전 종료 |
| **P** | 일시정지/재시작 | 거래 일시정지 |
| **R** | 리셋 | 모든 포지션 청산 및 초기화 |
| **S** | 설정 | 시스템 설정 변경 |
| **T** | 거래내역 | 전체 거래 내역 보기 |
| **H** | 도움말 | 키보드 단축키 안내 |

#### 색상 코드
- 🟢 **녹색**: 수익, 매수, 정상 상태
- 🔴 **빨간색**: 손실, 매도, 경고 상태  
- 🟡 **노란색**: 주의, 중립
- 🔵 **파란색**: 정보, 헤더
- ⚫ **회색**: 비활성, 보조 정보

---

## 설정 관리

### 6.1 환경 변수 설정 (.env)

```bash
# Binance API (실제 거래 시 필요)
BINANCE_API_KEY=your_api_key_here
BINANCE_SECRET_KEY=your_secret_key_here
BINANCE_TESTNET=False

# 거래 모드 (backtest, paper, live)
TRADING_MODE=paper

# 로그 레벨 (DEBUG, INFO, WARNING, ERROR)
LOG_LEVEL=INFO

# 백테스트 기본 설정
DEFAULT_INITIAL_BALANCE=10000
DEFAULT_TIMEFRAME=1d
```

### 6.2 시스템 설정 (config.py)

#### 터틀 전략 상수 (변경 금지)
```python
RISK_PER_TRADE = 0.01        # 거래당 리스크 (1%)
MAX_RISK_TOTAL = 0.20        # 총 최대 리스크 (20%)
ATR_PERIOD = 20              # ATR 계산 기간
MAX_UNITS_PER_MARKET = 4     # 종목당 최대 유닛
STOP_LOSS_MULTIPLIER = 2.0   # 손절가: 2N
PYRAMID_MULTIPLIER = 0.5     # 피라미딩: 0.5N
```

#### 시스템별 설정
```python
SYSTEM_1 = {
    'ENTRY_PERIOD': 20,      # 진입: 20일 돌파
    'EXIT_PERIOD': 10,       # 청산: 10일 돌파  
    'USE_FILTER': True       # 손실 필터 사용
}

SYSTEM_2 = {
    'ENTRY_PERIOD': 55,      # 진입: 55일 돌파
    'EXIT_PERIOD': 20,       # 청산: 20일 돌파
    'USE_FILTER': False      # 필터 미사용
}
```

### 6.3 설정 유효성 검증

프로그램 시작 시 자동으로 설정을 검증합니다:
```bash
python config.py
```

성공 시:
```
✅ 모든 설정이 유효합니다.
```

오류 시:
```
❌ 설정 오류:
BINANCE_API_KEY가 설정되지 않았습니다.
```

---

## 문제 해결

### 7.1 일반적인 문제

#### Q1: 프로그램이 시작되지 않아요
**원인**: 의존성 패키지 누락
**해결**:
```bash
pip install -r requirements.txt
```

#### Q2: 백테스트가 너무 오래 걸려요
**원인**: 너무 긴 기간 또는 짧은 타임프레임
**해결**:
- 더 짧은 기간으로 테스트 (6개월 → 3개월)
- 더 긴 타임프레임 사용 (1h → 1d)
- 시스템 1개만 사용

#### Q3: Binance API 연결이 안 돼요
**원인**: API 키 설정 오류 또는 네트워크 문제
**해결**:
1. `.env` 파일의 API 키 확인
2. Binance API 권한 설정 확인  
3. 네트워크 연결 상태 점검
4. 방화벽/VPN 설정 확인

#### Q4: 백테스트 결과가 이상해요
**원인**: 데이터 부족 또는 설정 오류
**해결**:
- 최소 55일 이상의 데이터 기간 확인
- 수수료 설정 확인 (0.04% = 0.0004)
- 시작일이 종료일보다 이전인지 확인

### 7.2 로그 확인 방법

#### 로그 파일 위치
```
logs/
├── trading.log       # 전체 시스템 로그
├── backtest.log      # 백테스트 전용 로그  
├── error.log         # 에러 로그
└── trades.log        # 거래 내역 로그
```

#### 로그 확인 명령어
```bash
# 최근 로그 확인
tail -f logs/trading.log

# 에러 로그만 확인  
tail -f logs/error.log

# 특정 날짜 로그 검색
grep "2025-06-12" logs/trading.log
```

### 7.3 성능 최적화

#### 메모리 사용량 줄이기
- 백테스트 기간 단축
- 타임프레임 확대 (1m → 1h)
- 시스템 1개만 사용

#### 실행 속도 향상
- SSD 사용 권장
- 안정적인 인터넷 연결
- 백그라운드 프로그램 최소화

### 7.4 비상 상황 대응

#### 긴급 거래 중지
1. **키보드**: `Ctrl+C` 또는 `Q` 키
2. **터미널 종료**: 터미널 창 닫기
3. **수동 청산**: Binance 앱/웹에서 직접 청산

#### 시스템 복구
```bash
# 1. 프로그램 재시작
python main.py

# 2. 설정 초기화
cp .env.example .env

# 3. 로그 삭제 (필요시)
rm -rf logs/*
```

### 7.5 지원 요청

문제가 해결되지 않을 경우:

1. **로그 수집**: 관련 로그 파일 복사
2. **환경 정보**: OS, Python 버전, 설치된 패키지 목록
3. **재현 단계**: 문제 발생까지의 정확한 단계
4. **스크린샷**: 오류 메시지 화면 캡처

**연락처**: GitHub Issues 또는 이메일로 문의

---

## 📝 참고 자료

- [터틀 트레이딩 원서](https://en.wikipedia.org/wiki/Turtle_trading)
- [Binance API 문서](https://binance-docs.github.io/apidocs/)
- [Rich 라이브러리 문서](https://rich.readthedocs.io/)
- [Python asyncio 가이드](https://docs.python.org/3/library/asyncio.html)

**🚀 Happy Trading with Turtle Strategy! 🐢**